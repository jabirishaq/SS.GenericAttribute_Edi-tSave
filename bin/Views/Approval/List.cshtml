@model IList<SmartStore.Admin.Models.Approvals.ApprovalUsageHistoryModel>

@using Telerik.Web.Mvc.UI;
@using SmartStore.Web.Framework.UI;
@using System.Web.Mvc;
@using System.Web.Routing;
@using Newtonsoft.Json;
@{
    Layout = "_AdminGrids";
}

<div class="page shopping-cart-page">
    <div class="page-title">
        <h1 class="h3">Orders waiting for approval</h1>
    </div>

    <div class="page-body">

        <div class="row">
            <div class="col-md-11">
                <div class="input-group">
                    <input type="text" id="searchApproval" class="form-control" placeholder="Search...">
                    <a id="searchOrderListBoxClear" class="btn bg-transparent" style="border:none; margin-left: -40px; z-index: 100;">
                        <i class="fa fa-times"></i>
                    </a>
                </div>
            </div>
            <div class="form-group col-md-1">
                <button type="button" id="btnSearchApproval" class="btn btn-primary">Search</button>
            </div>
        </div>
        <br />
        <div>
            @(Html.Telerik().Grid<SmartStore.Admin.Models.Approvals.ApprovalUsageHistoryModel>()
            .Name("order-approvals-grid")
            .Columns(columns =>
            {
                columns.Bound(x => x.OrderId)
                    .Width(500)
                    .ClientTemplate("<a href=\"/Approval/Details?auhId=<#= Id #>\"><#= OrderId #></a>");
			    columns.Bound(x => x.CustomerName).Title("Name").Centered();
                columns.Bound(x => x.NumberOfProducts).Title("Number of Products").Centered();
                columns.Bound(x => x.CreatedOn).Title("Created On").Centered();
            })
            .DataBinding(dataBinding => dataBinding.Ajax().Select("OrdersApprovalList", "Approval"))
            .ClientEvents(events => events.OnDataBinding("onDataBinding"))
            .EnableCustomBinding(true))
        </div>
    </div>
</div>

<script>

    $(document).on('click', '#btnSearchApproval', function () {
        
        var approvalGrid = $("#order-approvals-grid").data("tGrid");
        approvalGrid.currentPage = 1;
        approvalGrid.ajaxRequest();
    });

    $(document).on('click', '#searchOrderListBoxClear', function () {
        $("searchApproval").val('');
    });

    function onDataBinding(e) {
        var searchVal = $("#searchApproval").val();
        e.data = { searchTerm: searchVal };
    }
</script>